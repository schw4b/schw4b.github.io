<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Simon Schwab">
<meta name="dcterms.date" content="2025-03-30">
<meta name="description" content="Confounding leads to wrong conclusions in medical research. Model-based approaches, like multivariable regression models, offer a more accurate way to account for multiple confounders and estimate true effects. Ultimately, models provide the most reliable framework for understanding complex data and making informed clinical decisions.">

<title>Land of confusion – Statistics, yup!</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<link href="../../images/logo-96.png" rel="icon" type="image/png">
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-b8d798ad51aeed766369f7220de90afb.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-GPR2YZSX56"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-GPR2YZSX56', { 'anonymize_ip': true});
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Land of confusion – Statistics, yup!">
<meta property="og:description" content="Confounding leads to wrong conclusions in medical research. Model-based approaches, like multivariable regression models, offer a more accurate way to account for multiple confounders and estimate true effects. Ultimately, models provide the most reliable framework for understanding complex data and making informed clinical decisions.">
<meta property="og:image" content="https://www.statsyup.org/posts/confusion/katie-moum-5FHv5nS7yGg-unsplash.jpg">
<meta property="og:site_name" content="Statistics, yup!">
<meta name="citation_title" content="Land of confusion">
<meta name="citation_author" content="Simon Schwab">
<meta name="citation_publication_date" content="2025">
<meta name="citation_cover_date" content="2025">
<meta name="citation_year" content="2025">
<meta name="citation_online_date" content="2025-03-30">
<meta name="citation_fulltext_html_url" content="https://www.statsyup.org/posts/confusion/">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=Hormone replacement therapy and cardiovascular disease: What went wrong and where do we go from here?;,citation_author=Raghvendra K Dubey;,citation_author=Bruno Imthurn;,citation_author=Lefteris C Zacharia;,citation_author=Edwin K Jackson;,citation_publication_date=2004-12;,citation_cover_date=2004-12;,citation_year=2004;,citation_issue=6;,citation_doi=10.1161/01.hyp.0000145988.95551.28;,citation_issn=0194-911X,1524-4563;,citation_volume=44;,citation_journal_title=Hypertension;,citation_publisher=Ovid Technologies (Wolters Kluwer Health);">
<meta name="citation_reference" content="citation_title=Postmenopausal hormone replacement therapy and the primary prevention of cardiovascular disease;,citation_author=Linda L Humphrey;,citation_author=Benjamin K S Chan;,citation_author=Harold C Sox;,citation_publication_date=2002-08;,citation_cover_date=2002-08;,citation_year=2002;,citation_issue=4;,citation_doi=10.7326/0003-4819-137-4-200208200-00012;,citation_issn=0003-4819,1539-3704;,citation_pmid=12186518;,citation_volume=137;,citation_journal_title=Ann. Intern. Med.;,citation_publisher=American College of Physicians;">
<meta name="citation_reference" content="citation_title=Association between tracheal intubation during pediatric in-hospital cardiac arrest and survival;,citation_author=Lars W Andersen;,citation_author=Tia T Raymond;,citation_author=Robert A Berg;,citation_author=Vinay M Nadkarni;,citation_author=Anne V Grossestreuer;,citation_author=Tobias Kurth;,citation_author=Michael W Donnino;,citation_author=American Heart Association’s Get With The Guidelines-Resuscitation Investigators;,citation_publication_date=2016-11;,citation_cover_date=2016-11;,citation_year=2016;,citation_issue=17;,citation_doi=10.1001/jama.2016.14486;,citation_issn=0098-7484,1538-3598;,citation_pmid=27701623;,citation_volume=316;,citation_journal_title=JAMA;,citation_publisher=American Medical Association;">
<meta name="citation_reference" content="citation_title=Confounding by indication in clinical research;,citation_author=Demetrios N Kyriacou;,citation_author=Roger J Lewis;,citation_publication_date=2016-11;,citation_cover_date=2016-11;,citation_year=2016;,citation_issue=17;,citation_doi=10.1001/jama.2016.16435;,citation_issn=0098-7484,1538-3598;,citation_volume=316;,citation_journal_title=JAMA;,citation_publisher=American Medical Association (AMA);">
<meta name="citation_reference" content="citation_title=Using propensity score methods to create target populations in observational clinical research;,citation_author=Laine Thomas;,citation_author=Fan Li;,citation_author=Michael Pencina;,citation_publication_date=2020-02;,citation_cover_date=2020-02;,citation_year=2020;,citation_issue=5;,citation_doi=10.1001/jama.2019.21558;,citation_issn=0098-7484,1538-3598;,citation_pmid=31922529;,citation_volume=323;,citation_journal_title=JAMA;,citation_publisher=American Medical Association (AMA);">
<meta name="citation_reference" content="citation_title=The propensity score;,citation_author=Jason S Haukoos;,citation_author=Roger J Lewis;,citation_publication_date=2015-10;,citation_cover_date=2015-10;,citation_year=2015;,citation_issue=15;,citation_doi=10.1001/jama.2015.13480;,citation_issn=0098-7484,1538-3598;,citation_volume=314;,citation_journal_title=JAMA;,citation_publisher=American Medical Association (AMA);">
<meta name="citation_reference" content="citation_title=Regression modeling strategies: With applications to linear models, logistic and ordinal regression, and survival analysis;,citation_author=Frank E Harrell;,citation_publication_date=2015-08;,citation_cover_date=2015-08;,citation_year=2015;,citation_doi=10.1007/978-3-319-19425-7;,citation_isbn=9783319194240,9783319194257;,citation_issn=0172-7397,2197-568X;,citation_series_title=Springer series in statistics;">
<meta name="citation_reference" content="citation_title=Analytical methods for social research: Data analysis using regression and multilevel/hierarchical models;,citation_author=Andrew Gelman;,citation_author=Jennifer Hill;,citation_publication_date=2006-12;,citation_cover_date=2006-12;,citation_year=2006;,citation_doi=10.1017/cbo9780511790942;,citation_isbn=9780521686891;">
<meta name="citation_reference" content="citation_title=Causal inference about the effects of interventions from observational studies in medical journals;,citation_author=Issa J Dahabreh;,citation_author=Kirsten Bibbins-Domingo;,citation_publication_date=2024-06;,citation_cover_date=2024-06;,citation_year=2024;,citation_issue=21;,citation_doi=10.1001/jama.2024.7741;,citation_issn=0098-7484,1538-3598;,citation_pmid=38722735;,citation_volume=331;,citation_journal_title=JAMA;,citation_publisher=American Medical Association (AMA);">
<meta name="citation_reference" content="citation_title=Impact of obesity on heart transplantation outcomes;,citation_author=Fouad Chouairi;,citation_author=Aidan Milner;,citation_author=Sounok Sen;,citation_author=Avirup Guha;,citation_author=James Stewart;,citation_author=Ania M Jastreboff;,citation_author=Makoto Mori;,citation_author=Katherine A Clark;,citation_author=P Elliott Miller;,citation_author=Michael A Fuery;,citation_author=Joseph G Rogers;,citation_author=Andrew Notarianni;,citation_author=Daniel Jacoby;,citation_author=Christopher Maulion;,citation_author=Muhammad Anwer;,citation_author=Arnar Geirsson;,citation_author=Nihar R Desai;,citation_author=Tariq Ahmad;,citation_author=Clancy W Mullan;,citation_publication_date=2021-12;,citation_cover_date=2021-12;,citation_year=2021;,citation_issue=23;,citation_doi=10.1161/JAHA.121.021346;,citation_issn=2047-9980;,citation_pmid=34854316;,citation_volume=10;,citation_journal_title=J. Am. Heart Assoc.;,citation_publisher=Ovid Technologies (Wolters Kluwer Health);">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/logo.png" alt="A statistics chart as logo." class="navbar-logo">
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Bio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../output.html"> 
<span class="menu-text">Output</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../posts.html"> 
<span class="menu-text">Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../library.html"> 
<span class="menu-text">Library</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Land of confusion</h1>
                  <div>
        <div class="description">
          Confounding leads to wrong conclusions in medical research. Model-based approaches, like multivariable regression models, offer a more accurate way to account for multiple confounders and estimate true effects. Ultimately, models provide the most reliable framework for understanding complex data and making informed clinical decisions.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Confounding</div>
                <div class="quarto-category">Statistical modeling</div>
                <div class="quarto-category">Multivariable models</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Simon Schwab </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 30, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#how-can-we-reduce-confounding" id="toc-how-can-we-reduce-confounding" class="nav-link active" data-scroll-target="#how-can-we-reduce-confounding">How can we reduce confounding?</a></li>
  <li><a href="#everything-will-mislead-you-except-a-model" id="toc-everything-will-mislead-you-except-a-model" class="nav-link" data-scroll-target="#everything-will-mislead-you-except-a-model">Everything will mislead you except a model</a></li>
  <li><a href="#just-one-more-thing" id="toc-just-one-more-thing" class="nav-link" data-scroll-target="#just-one-more-thing">Just one more thing</a>
  <ul class="collapse">
  <li><a href="#testing-is-futile" id="toc-testing-is-futile" class="nav-link" data-scroll-target="#testing-is-futile">Testing is futile</a></li>
  <li><a href="#its-a-bird-its-a-plane-its-a-model" id="toc-its-a-bird-its-a-plane-its-a-model" class="nav-link" data-scroll-target="#its-a-bird-its-a-plane-its-a-model">It’s a bird, it’s a plane, it’s a model!</a></li>
  <li><a href="#so-what" id="toc-so-what" class="nav-link" data-scroll-target="#so-what">So what?</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>Have you ever been confused about data and evidence? Frankly, I find myself confused in data many times. The real goal isn’t to eliminate confusion entirely but to reduce it and gain some sense of certainty. One such thing that can be truly confusing in medical research is confounding.</p>
<p>But what is confounding? Confounding bias occurs when a third variable is associated with a risk factor (or treatment) and also influences the health outcome, leading to a wrong result. This can either create a false relationship or hide a real one.</p>
<p>I make up an example. Say, doctors have higher cancer rates. The confounding factor may be smoking if doctors tend to smoke more, and smoking causes cancer. So, no, being a doctor per se does not cause cancer at all.</p>
<p>After a literature search, I found two excellent examples from published medical studies where confounding occurred.</p>
<p>In the 1990s, observational studies suggested that hormone replacement therapy (HRT) reduced the risk of cardiovascular disease (CVD) in women <span class="citation" data-cites="Dubey2004-dm">[<a href="#ref-Dubey2004-dm" role="doc-biblioref">1</a>]</span>. However, this association was most likely false. Subsequent randomized controlled trials and a meta-analysis from 2002 found no evidence that HRT reduced the risk of CVD <span class="citation" data-cites="Humphrey2002-oz">[<a href="#ref-Humphrey2002-oz" role="doc-biblioref">2</a>]</span>. The apparent benefits were likely influenced by confounders such as socioeconomic status and education. Lower socioeconomic status is a strong risk factor for CVD, coronary artery disease, and many other adverse health outcomes. Additionally, women using HRT tend to have higher socioeconomic status, which may partially explain their better outcomes in earlier studies.</p>
<p>A 2016 observational study compared tracheal intubation to bag-valve-mask ventilation during pediatric cardiac arrest <span class="citation" data-cites="Andersen2016-pe">[<a href="#ref-Andersen2016-pe" role="doc-biblioref">3</a>]</span>. The study found that survival was lower in those children intubated compared with those not intubated. The authors concluded that the study does not support early tracheal intubation for pediatric in-hospital cardiac arrest. However, the study suffered from confounding by indication <span class="citation" data-cites="Kyriacou2016-ma">[<a href="#ref-Kyriacou2016-ma" role="doc-biblioref">4</a>]</span>. It was likely that children with a more severe condition and worse overall prognosis had a greater probability of being intubated. Consequently, the treatment group showed a higher risk of death.</p>
<p>The two examples show that confounding can confuse doctors in making the right choice based on solid evidence. Needless to say, this can potentially harm patients.</p>
<blockquote class="blockquote">
<p>Can’t you see this is a land of confusion? This is the world we live in. —Land of confusion (song by Genesis)</p>
</blockquote>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="wasserfall.jpg" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption>Waterfall by M. C. Escher</figcaption>
</figure>
</div>
<section id="how-can-we-reduce-confounding" class="level2">
<h2 class="anchored" data-anchor-id="how-can-we-reduce-confounding">How can we reduce confounding?</h2>
<p>There are several ways to address confounding in medical research. One is study design, including randomized controlled trials (RCTs), which are highly effective and provide strong evidence.</p>
<p>Say, we are interested in the therapeutic effect of hypothermic machine perfusion (HMP) in kidney transplantation. We could perform an RCT and randomize the kidneys into a control group (standard cold storage) and an intervention group (HMP).</p>
<p>However, an RCT is not always possible. For example, if we want to assess the risk of donation after brain death (DBD) versus donation after circulatory death (DCD) kidney transplants, it is not possible to randomly assign kidneys to either group. Similarly, just as we cannot randomly assign individuals to be smokers or non-smokers, certain real-world conditions make randomization impossible.</p>
<p>There are also other approaches to tackle confounding, including matching and propensity score methods, which pair participants with similar clinical characteristics to reduce confounding <span class="citation" data-cites="Thomas2020-uq Haukoos2015-bg">[<a href="#ref-Thomas2020-uq" role="doc-biblioref">5</a>,<a href="#ref-Haukoos2015-bg" role="doc-biblioref">6</a>]</span>. It is important to carefully select the matching variables, choose an appropriate matching method, and perform a diagnostic assessment of the matching process. Additionally, stratified analysis helps control for confounding by analyzing data within specific subgroups.</p>
<p>In the remainder of this post, I will focus on another key approach: multivariable regression modeling. This method allows researchers to account for multiple confounders simultaneously by including them as covariates in a regression model, helping to isolate the true relationship between the exposure and outcome of interest.</p>
</section>
<section id="everything-will-mislead-you-except-a-model" class="level2">
<h2 class="anchored" data-anchor-id="everything-will-mislead-you-except-a-model">Everything will mislead you except a model</h2>
<blockquote class="blockquote">
<p>A model is a lie that helps you see the truth. —Howard E. Skipper</p>
</blockquote>
<p>I’m a big fan of model-based approaches <span class="citation" data-cites="Harrell2015-pf Gelman2006-tp">[<a href="#ref-Harrell2015-pf" role="doc-biblioref">7</a>,<a href="#ref-Gelman2006-tp" role="doc-biblioref">8</a>]</span>. Models provide the most comprehensive description of data. Unlike traditional statistical hypothesis tests, which focus primarily on detecting differences, models emphasize estimation, making results more meaningful for patients and clinicians.</p>
<p>One major advantage of models is their ability to adjust for multiple factors simultaneously, providing more accurate effect estimates. While researchers often focus on multiplicity adjustments for p-values, they rarely apply similar adjustments to effect estimates. Models, however, allow for these adjustments because the effect of interest is fully conditional on covariate values. In other words, model-based methods are much more powerful and reliable than analyzing variables in isolation.</p>
<p>For instance, consider a scenario in kidney transplantation, where we want to assess the impact of the deceased donor’s age increasing from 50 to 65 while holding other risk factors constant. A simple subgroup comparison—such as analyzing younger versus older donors doesn’t provide a reasonable estimate of this specific effect. A model, however, allows us to quantify the risk associated with this change while controlling for other variables as well.</p>
<p>Models also generalize statistical tests. For example, a <em>t</em>-test and ANOVA can be performed using multiple linear regression. Similarly, the Wilcoxon test and Kruskal-Wallis test correspond to a proportional odds model, while the log-rank test is a special case of the Cox proportional hazards model.</p>
<p>Ultimately, a model-based approach is the most accurate description of your data. However, it cannot definitively establish causality without careful attention to the research question, causal estimand, study design, and underlying assumptions <span class="citation" data-cites="Dahabreh2024-dw">[<a href="#ref-Dahabreh2024-dw" role="doc-biblioref">9</a>]</span>.</p>
<p>In the end, you have the choice: get confused by analyzing variables individually or let a statistical model confuse you all at once.</p>
<p><em>The title of this post is a song by Genesis; the preview image of this post is a photo by Katie Moum on Unsplash.</em></p>
</section>
<section id="just-one-more-thing" class="level2">
<h2 class="anchored" data-anchor-id="just-one-more-thing">Just one more thing</h2>
<p>I performed a simulation study with an example from the heart transplant waiting list. Again, this is not real data; I made this up. All data were generated from the following assumptions.</p>
<ul>
<li>I generated data for 2,000 patients</li>
<li>25% were female (500 patients) and 75% were male (1500 patients)</li>
<li>Females had an average weight of 65 kg with a standard deviation of 10 kg</li>
<li>Males had an average weight of 80 kg with a standard deviation of 10 kg</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Install the swt package</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># remotes::install_github("Swisstransplant/swt")</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(swt)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rms)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">2000</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">=</span> <span class="fl">0.25</span><span class="sc">*</span>N <span class="co"># female </span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">=</span> <span class="fl">0.75</span><span class="sc">*</span>N <span class="co"># male</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>heart <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">weight =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, N),</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sex =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"female"</span>, n1), <span class="fu">rep</span>(<span class="st">"male"</span>, n2))</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>heart<span class="sc">$</span>weight[heart<span class="sc">$</span>sex <span class="sc">==</span> <span class="st">"female"</span>] <span class="ot">=</span> <span class="fu">rnorm</span>(n1, <span class="at">mean =</span> <span class="dv">65</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>heart<span class="sc">$</span>weight[heart<span class="sc">$</span>sex <span class="sc">==</span> <span class="st">"male"</span>] <span class="ot">=</span> <span class="fu">rnorm</span>(n2, <span class="at">mean =</span> <span class="dv">80</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, I generated the probabilities for a heart transplant as an inverse function of body weight. As body weight increases, the likelihood of receiving a matching heart transplant decreases. Research supports this inverse relationship between body weight and transplant probability: larger individuals require greater cardiac output, and a smaller donor heart may struggle to meet these demands, potentially leading to poor circulation and organ failure <span class="citation" data-cites="Chouairi2021-bk">[<a href="#ref-Chouairi2021-bk" role="doc-biblioref">10</a>]</span>.</p>
<p>I sampled from a binomial distribution to determine whether each patient received a transplant or not based on their individual probability. In my simulation, the probability of a transplant depended solely on body weight and not on sex. Precisely, the probability was constant at 0.80 until 65 kg; then it decreased as a quadratic function.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function with constant prob until 65, then declines</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>prob_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  prob <span class="ot">=</span> <span class="fu">ifelse</span>(x <span class="sc">&lt;=</span> <span class="dv">65</span>, <span class="fl">0.8</span>, <span class="fl">0.8</span> <span class="sc">-</span> (x <span class="sc">-</span> <span class="dv">65</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2200</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">pmax</span>(prob, <span class="dv">0</span>))  </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>heart<span class="sc">$</span>P <span class="ot">=</span> <span class="fu">sapply</span>(heart<span class="sc">$</span>weight, <span class="at">FUN =</span> prob_fun)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>heart<span class="sc">$</span>P <span class="ot">=</span> heart<span class="sc">$</span>P <span class="sc">+</span> <span class="fu">rnorm</span>(N, <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.1</span>) <span class="co"># add some noise</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>heart<span class="sc">$</span>P[heart<span class="sc">$</span>P <span class="sc">&gt;</span> <span class="dv">1</span>] <span class="ot">=</span> <span class="dv">1</span> <span class="co"># truncate probabilities</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>heart<span class="sc">$</span>P[heart<span class="sc">$</span>P <span class="sc">&lt;</span> <span class="dv">0</span>] <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>heart<span class="sc">$</span>event <span class="ot">=</span> <span class="fu">rbinom</span>(N, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> heart<span class="sc">$</span>P)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>heart<span class="sc">$</span>event <span class="ot">=</span> heart<span class="sc">$</span>event <span class="sc">==</span> <span class="dv">1</span> <span class="co"># binary conversion</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The simulated data for 10 randomly picked patients are shown in Table 1. Figure 1 and Table 2 display descriptives of the data.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1986</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(heart), <span class="dv">7</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>heart[idx,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<caption>Table 1: Data from seven randomly picked patients. P is the probability of a heart transplant as a function of body weight; the event is a binary variable indicating whether a patient received a heart transplant.</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">weight</th>
<th style="text-align: left;">sex</th>
<th style="text-align: right;">P</th>
<th style="text-align: left;">event</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">840</td>
<td style="text-align: right;">72.26087</td>
<td style="text-align: left;">male</td>
<td style="text-align: right;">0.8648124</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: left;">1434</td>
<td style="text-align: right;">93.79369</td>
<td style="text-align: left;">male</td>
<td style="text-align: right;">0.3070354</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1083</td>
<td style="text-align: right;">67.71200</td>
<td style="text-align: left;">male</td>
<td style="text-align: right;">0.7036489</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: left;">1219</td>
<td style="text-align: right;">93.54775</td>
<td style="text-align: left;">male</td>
<td style="text-align: right;">0.5773796</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">406</td>
<td style="text-align: right;">73.69477</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">0.7522511</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: left;">142</td>
<td style="text-align: right;">45.84125</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">0.8791807</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">737</td>
<td style="text-align: right;">83.48071</td>
<td style="text-align: left;">male</td>
<td style="text-align: right;">0.6698299</td>
<td style="text-align: left;">TRUE</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(heart<span class="sc">$</span>weight, <span class="at">ylab =</span> <span class="st">"Count"</span>, <span class="at">xlab =</span> <span class="st">"Body weight (kg)"</span>, <span class="at">col =</span> <span class="st">"#818C70"</span>, <span class="at">main=</span><span class="cn">NULL</span>, </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.lab =</span> <span class="fl">1.3</span>, <span class="at">cex.axis =</span> <span class="fl">1.3</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(heart<span class="sc">$</span>P, <span class="at">ylab =</span> <span class="st">"Count"</span>, <span class="at">xlab =</span> <span class="st">"Transplant probability"</span>, <span class="at">col =</span> <span class="st">"#BF505A"</span>, <span class="at">main=</span><span class="cn">NULL</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.lab =</span> <span class="fl">1.3</span>, <span class="at">cex.axis =</span> <span class="fl">1.3</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(heart$weight, sapply(heart$weight, FUN = prob_fun))</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(heart<span class="sc">$</span>weight, heart<span class="sc">$</span>P,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Body weight (kg)"</span>, <span class="at">ylab =</span> <span class="st">"Transplant probability"</span>, <span class="at">col =</span> <span class="st">"#6F87A6"</span>,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.lab =</span> <span class="fl">1.3</span>, <span class="at">cex.axis =</span> <span class="fl">1.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Figure 1: Distribution of body weight, transplant probabilities, and their relationship.</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">N =</span> <span class="fu">nrow</span>(heart),</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">weight =</span> swt<span class="sc">::</span><span class="fu">mean_sd</span>(heart<span class="sc">$</span>weight),</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">transplant =</span> swt<span class="sc">::</span><span class="fu">freq_perc</span>(heart<span class="sc">$</span>event)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>heart.males   <span class="ot">=</span> <span class="fu">subset</span>(heart, <span class="at">subset =</span> sex <span class="sc">==</span> <span class="st">"male"</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>heart.females <span class="ot">=</span> <span class="fu">subset</span>(heart, <span class="at">subset =</span> sex <span class="sc">==</span> <span class="st">"female"</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>tab.m <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">N =</span> <span class="fu">nrow</span>(heart.males),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">weight =</span> swt<span class="sc">::</span><span class="fu">mean_sd</span>(heart.males<span class="sc">$</span>weight),</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">transplant =</span> swt<span class="sc">::</span><span class="fu">freq_perc</span>(heart.males<span class="sc">$</span>event)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>tab.f <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">N =</span> <span class="fu">nrow</span>(heart.females),</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">weight =</span> swt<span class="sc">::</span><span class="fu">mean_sd</span>(heart.females<span class="sc">$</span>weight),</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">transplant =</span> swt<span class="sc">::</span><span class="fu">freq_perc</span>(heart.females<span class="sc">$</span>event)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">rbind</span>(tab, tab.f, tab.m)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(tab))</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Overall"</span>, <span class="st">"Female"</span>, <span class="st">"Male"</span>)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(tab) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Sample size N"</span>, <span class="st">"Body weight in kg, mean (SD)"</span>,</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Transplant, count (%)"</span>)</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>tab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<caption>Table 2: Descriptives.</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Overall</th>
<th style="text-align: left;">Female</th>
<th style="text-align: left;">Male</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Sample size N</td>
<td style="text-align: left;">2000</td>
<td style="text-align: left;">500</td>
<td style="text-align: left;">1500</td>
</tr>
<tr class="even">
<td style="text-align: left;">Body weight in kg, mean (SD)</td>
<td style="text-align: left;">76.0 (12.0)</td>
<td style="text-align: left;">65.0 (9.9)</td>
<td style="text-align: left;">79.7 (10.2)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Transplant, count (%)</td>
<td style="text-align: left;">1374 (68.7)</td>
<td style="text-align: left;">384 (76.8)</td>
<td style="text-align: left;">990 (66.0)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>As expected, females had an average weight of approximately 65 kg; males around 80 kg. Among females, about 77% received a transplant, compared to 66% of males.</p>
<section id="testing-is-futile" class="level3">
<h3 class="anchored" data-anchor-id="testing-is-futile">Testing is futile</h3>
<p>I tested whether sex was independent of a heart transplant using Pearson’s <span class="math inline">\(\chi^2\)</span>-test for count data. I knew this was a bad idea, but since looking at variables individually is common in medical research, doing it one more time didn’t hurt.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">=</span> <span class="fu">table</span>(heart<span class="sc">$</span>event, heart<span class="sc">$</span>sex)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>nontpx.fmt <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%d (%.1f)"</span>, M[<span class="dv">1</span>,], M[<span class="dv">1</span>,]<span class="sc">/</span><span class="fu">marginSums</span>(M, <span class="at">margin =</span> <span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>tpx.fmt    <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%d (%.1f)"</span>, M[<span class="dv">2</span>,], M[<span class="dv">2</span>,]<span class="sc">/</span><span class="fu">marginSums</span>(M, <span class="at">margin =</span> <span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>tab.fmt <span class="ot">=</span> <span class="fu">rbind</span>(nontpx.fmt, tpx.fmt)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">as.data.frame</span>(tab.fmt)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(tab) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"no transplant"</span>, <span class="st">"transplant"</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"female"</span>, <span class="st">"male"</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>tab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<caption>Table 3: Contingency table with counts (%) showing the relationship between sex and heart transplant status.</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">female</th>
<th style="text-align: left;">male</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">no transplant</td>
<td style="text-align: left;">116 (23.2)</td>
<td style="text-align: left;">510 (34.0)</td>
</tr>
<tr class="even">
<td style="text-align: left;">transplant</td>
<td style="text-align: left;">384 (76.8)</td>
<td style="text-align: left;">990 (66.0)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">=</span> <span class="fu">chisq.test</span>(M, <span class="at">correct =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>I found that more females received a transplant than expected (384 versus 343.5), while fewer males received a transplant than expected (990 versus 1030.5). This provided strong evidence that sex was related to receiving a heart transplant (<em>p</em> &lt; 0.001).</p>
<p>But what was the issue? This simple analysis failed to capture the whole picture. Weight was related to both sex and the likelihood of receiving a heart transplant. Females typically have lower body weight, and heavier individuals are less likely to receive a heart transplant. Therefore, the weight acts as a confounder. If I were unaware of weight, I might incorrectly conclude that being female increases the likelihood of receiving a heart transplant. However, this was not the case and would only mislead us, as a heavy female would have a low chance of a transplant, while a lightweight male would have a higher chance.</p>
</section>
<section id="its-a-bird-its-a-plane-its-a-model" class="level3">
<h3 class="anchored" data-anchor-id="its-a-bird-its-a-plane-its-a-model">It’s a bird, it’s a plane, it’s a model!</h3>
<p>Next, I analyzed the data all at once using a logistic regression model. The results are shown in Table 4. Figure 2 shows the relationship between weight and the chance of a heart transplant.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">=</span> <span class="fu">datadist</span>(heart)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">datadist=</span><span class="st">'dd'</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">lrm</span>(event <span class="sc">~</span> sex <span class="sc">+</span> <span class="fu">rcs</span>(weight, <span class="dv">3</span>), <span class="at">data =</span> heart)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>swt<span class="sc">::</span><span class="fu">tidy_rmsfit</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<caption>Table 4: Results from a logistic regression model.</caption>
<colgroup>
<col style="width: 17%">
<col style="width: 26%">
<col style="width: 26%">
<col style="width: 11%">
<col style="width: 5%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Interquartile difference</th>
<th style="text-align: left;">Odds ratio (95%-CI)</th>
<th style="text-align: left;">Chi-Square</th>
<th style="text-align: left;">d.f.</th>
<th style="text-align: left;">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">sex</td>
<td style="text-align: left;">–</td>
<td style="text-align: left;">–</td>
<td style="text-align: left;">0.0138</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">0.91</td>
</tr>
<tr class="even">
<td style="text-align: left;">sex female</td>
<td style="text-align: left;">–</td>
<td style="text-align: left;">1.02 (from 0.76 to 1.36)</td>
<td style="text-align: left;">–</td>
<td style="text-align: left;">–</td>
<td style="text-align: left;">–</td>
</tr>
<tr class="odd">
<td style="text-align: left;">weight</td>
<td style="text-align: left;">16.12 (68.07–84.19)</td>
<td style="text-align: left;">0.49 (from 0.42 to 0.57)</td>
<td style="text-align: left;">119</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">&lt; 0.001 ***</td>
</tr>
<tr class="even">
<td style="text-align: left;">weight nonlinear</td>
<td style="text-align: left;">–</td>
<td style="text-align: left;">–</td>
<td style="text-align: left;">33.5</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">&lt; 0.001 ***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TOTAL</td>
<td style="text-align: left;">–</td>
<td style="text-align: left;">–</td>
<td style="text-align: left;">139</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">&lt; 0.001 ***</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>av <span class="ot">=</span> <span class="fu">anova</span>(fit)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">Predict</span>(fit, weight), <span class="at">anova =</span> av, <span class="at">colfill =</span> <span class="st">"#6F87A6"</span>, <span class="at">adj.subtitle =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Body weight (kg)"</span>) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="240"></p>
<figcaption>Figure 2: Partial effect of body weight and the chance of a heart transplant.</figcaption>
</figure>
</div>
</div>
</div>
<p>In conclusion, I found that body weight had a strong relationship with the chance of a heart transplant. Increasing weight from 69 kg to 84 kg was associated with roughly a 50% reduction in the chance of a heart transplant. No evidence was found for sex.</p>
</section>
<section id="so-what" class="level3">
<h3 class="anchored" data-anchor-id="so-what">So what?</h3>
<p>A model is often the best description of the data. Regression models are part of university-level statistics courses across life sciences. Thus, there is really no excuse for testing variables individually instead of using a statistical model.</p>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" role="list">
<div id="ref-Dubey2004-dm" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Dubey RK, Imthurn B, Zacharia LC, Jackson EK. Hormone replacement therapy and cardiovascular disease: What went wrong and where do we go from here? Hypertension. 2004;44: 789–795. doi:<a href="https://doi.org/10.1161/01.hyp.0000145988.95551.28">10.1161/01.hyp.0000145988.95551.28</a></div>
</div>
<div id="ref-Humphrey2002-oz" class="csl-entry" role="listitem">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Humphrey LL, Chan BKS, Sox HC. Postmenopausal hormone replacement therapy and the primary prevention of cardiovascular disease. Ann Intern Med. 2002;137: 273–284. doi:<a href="https://doi.org/10.7326/0003-4819-137-4-200208200-00012">10.7326/0003-4819-137-4-200208200-00012</a></div>
</div>
<div id="ref-Andersen2016-pe" class="csl-entry" role="listitem">
<div class="csl-left-margin">3. </div><div class="csl-right-inline">Andersen LW, Raymond TT, Berg RA, Nadkarni VM, Grossestreuer AV, Kurth T, et al. Association between tracheal intubation during pediatric in-hospital cardiac arrest and survival. JAMA. 2016;316: 1786–1797. doi:<a href="https://doi.org/10.1001/jama.2016.14486">10.1001/jama.2016.14486</a></div>
</div>
<div id="ref-Kyriacou2016-ma" class="csl-entry" role="listitem">
<div class="csl-left-margin">4. </div><div class="csl-right-inline">Kyriacou DN, Lewis RJ. Confounding by indication in clinical research. JAMA. 2016;316: 1818. doi:<a href="https://doi.org/10.1001/jama.2016.16435">10.1001/jama.2016.16435</a></div>
</div>
<div id="ref-Thomas2020-uq" class="csl-entry" role="listitem">
<div class="csl-left-margin">5. </div><div class="csl-right-inline">Thomas L, Li F, Pencina M. Using propensity score methods to create target populations in observational clinical research. JAMA. 2020;323: 466–467. doi:<a href="https://doi.org/10.1001/jama.2019.21558">10.1001/jama.2019.21558</a></div>
</div>
<div id="ref-Haukoos2015-bg" class="csl-entry" role="listitem">
<div class="csl-left-margin">6. </div><div class="csl-right-inline">Haukoos JS, Lewis RJ. The propensity score. JAMA. 2015;314: 1637. doi:<a href="https://doi.org/10.1001/jama.2015.13480">10.1001/jama.2015.13480</a></div>
</div>
<div id="ref-Harrell2015-pf" class="csl-entry" role="listitem">
<div class="csl-left-margin">7. </div><div class="csl-right-inline">Harrell FE. Regression modeling strategies: With applications to linear models, logistic and ordinal regression, and survival analysis. 2nd ed. Cham, Switzerland: Springer International Publishing; 2015. doi:<a href="https://doi.org/10.1007/978-3-319-19425-7">10.1007/978-3-319-19425-7</a></div>
</div>
<div id="ref-Gelman2006-tp" class="csl-entry" role="listitem">
<div class="csl-left-margin">8. </div><div class="csl-right-inline">Gelman A, Hill J. Analytical methods for social research: Data analysis using regression and multilevel/hierarchical models. Cambridge, England: Cambridge University Press; 2006. doi:<a href="https://doi.org/10.1017/cbo9780511790942">10.1017/cbo9780511790942</a></div>
</div>
<div id="ref-Dahabreh2024-dw" class="csl-entry" role="listitem">
<div class="csl-left-margin">9. </div><div class="csl-right-inline">Dahabreh IJ, Bibbins-Domingo K. Causal inference about the effects of interventions from observational studies in medical journals. JAMA. 2024;331: 1845–1853. doi:<a href="https://doi.org/10.1001/jama.2024.7741">10.1001/jama.2024.7741</a></div>
</div>
<div id="ref-Chouairi2021-bk" class="csl-entry" role="listitem">
<div class="csl-left-margin">10. </div><div class="csl-right-inline">Chouairi F, Milner A, Sen S, Guha A, Stewart J, Jastreboff AM, et al. Impact of obesity on heart transplantation outcomes. J Am Heart Assoc. 2021;10: e021346. doi:<a href="https://doi.org/10.1161/JAHA.121.021346">10.1161/JAHA.121.021346</a></div>
</div>
</div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@misc{schwab2025,
  author = {Schwab, Simon},
  title = {Land of Confusion},
  date = {2025},
  url = {https://www.statsyup.org/posts/confusion/},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-schwab2025" class="csl-entry quarto-appendix-citeas" role="listitem">
<div class="">Schwab S. Land of confusion. 2025. Available:
<a href="https://www.statsyup.org/posts/confusion/">https://www.statsyup.org/posts/confusion/</a></div>
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/www\.statsyup\.org\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© 2024, 2025 Simon Schwab</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>